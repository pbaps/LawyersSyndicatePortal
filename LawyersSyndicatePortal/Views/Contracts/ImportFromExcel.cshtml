@model LawyersSyndicatePortal.Models.PbaContract

@{
    ViewBag.Title = "استيراد من Excel";
}

<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow-lg border-0 rounded-lg">
                <div class="card-header bg-info text-white text-center">
                    <h3 class="font-weight-light my-4">@ViewBag.Title</h3>
                </div>
                <div class="card-body">
                    <!-- قسم تحميل النموذج -->
                    <div class="text-center mb-4">
                        <p class="lead">لتجنب الأخطاء، يرجى تحميل النموذج وإدخال البيانات فيه.</p>
                        @Html.ActionLink("تحميل نموذج Excel", "DownloadImportTemplate", null, new { @class = "btn btn-success btn-lg" })
                    </div>
                    <hr />

                    <!-- قسم رفع الملف -->
                    @using (Html.BeginForm("ImportFromExcel", "Contracts", FormMethod.Post, new { enctype = "multipart/form-data" }))
                    {
                        @Html.AntiForgeryToken()
                        <div class="form-horizontal text-right">
                            <h4 class="mb-4">تحميل ملف Excel لاستيراد البيانات</h4>

                            @if (ViewBag.Message != null)
                            {
                                <div class="alert alert-info text-center" role="alert">
                                    @ViewBag.Message
                                </div>
                            }

                            <div class="form-group row mt-4">
                                <label for="file" class="control-label col-md-4">اختر ملف Excel</label>
                                <div class="col-md-8">
                                    <input type="file" name="file" id="file" class="form-control" accept=".xlsx" />
                                </div>
                            </div>

                            <div class="form-group mt-5 text-center">
                                <div class="col-md-offset-2 col-md-10">
                                    <input type="submit" value="استيراد" class="btn btn-info btn-lg" />
                                    @Html.ActionLink("العودة إلى القائمة", "Index", null, new { @class = "btn btn-secondary btn-lg ml-2" })
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
